import{r as n,R as e,H as R,a as I}from"./app-BbDoMQAO.js";import{C as S,a as A,b as j,c as _,B as $}from"./badge-C1n_fp1a.js";import{B as L}from"./app-logo-icon-b2yb7qIm.js";import{F,Z as W,C as q,S as ee,a as te,b as se,c as le,d as G}from"./select-_Xfw7Mm4.js";import{a as U,T as K,G as ae,A as O,S as re}from"./app-layout-BZu3Gqed.js";import{E as M,B as ne}from"./external-link-Ct4EiCT2.js";import{l as oe,m as X,n as ce,P as ie,h as P,j as Z,H as d,o as p,q as me,r as ue,v as de,R as pe,C as Ee}from"./course-node-CJ9YmHm4.js";import{P as he}from"./plus-mQUy7A52.js";/* empty css            */import"./index-x8-gXqJn.js";import"./index-DtUKyc1Y.js";import"./index-BN0EMx2K.js";function xe(){return e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},e.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function ge(){return e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},e.createElement("path",{d:"M0 0h32v4.2H0z"}))}function fe(){return e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},e.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function we(){return e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},e.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Ne(){return e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},e.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const V=({children:t,className:l,...o})=>e.createElement("button",{type:"button",className:P(["react-flow__controls-button",l]),...o},t);V.displayName="ControlButton";const ye=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom}),J=({style:t,showZoom:l=!0,showFitView:o=!0,showInteractive:T=!0,fitViewOptions:c,onZoomIn:u,onZoomOut:y,onFitView:w,onInteractiveChange:v,className:k,children:i,position:z="bottom-left"})=>{const B=oe(),[H,b]=n.useState(!1),{isInteractive:E,minZoomReached:C,maxZoomReached:x}=X(ye,Z),{zoomIn:g,zoomOut:a,fitView:r}=ce();if(n.useEffect(()=>{b(!0)},[]),!H)return null;const h=()=>{g(),u==null||u()},f=()=>{a(),y==null||y()},s=()=>{r(c),w==null||w()},N=()=>{B.setState({nodesDraggable:!E,nodesConnectable:!E,elementsSelectable:!E}),v==null||v(!E)};return e.createElement(ie,{className:P(["react-flow__controls",k]),position:z,style:t,"data-testid":"rf__controls"},l&&e.createElement(e.Fragment,null,e.createElement(V,{onClick:h,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:x},e.createElement(xe,null)),e.createElement(V,{onClick:f,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:C},e.createElement(ge,null))),o&&e.createElement(V,{className:"react-flow__controls-fitview",onClick:s,title:"fit view","aria-label":"fit view"},e.createElement(fe,null)),T&&e.createElement(V,{className:"react-flow__controls-interactive",onClick:N,title:"toggle interactivity","aria-label":"toggle interactivity"},E?e.createElement(Ne,null):e.createElement(we,null)),i)};J.displayName="Controls";var ve=n.memo(J),m;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(m||(m={}));function ke({color:t,dimensions:l,lineWidth:o}){return e.createElement("path",{stroke:t,strokeWidth:o,d:`M${l[0]/2} 0 V${l[1]} M0 ${l[1]/2} H${l[0]}`})}function be({color:t,radius:l}){return e.createElement("circle",{cx:l,cy:l,r:l,fill:t})}const Ce={[m.Dots]:"#91919a",[m.Lines]:"#eee",[m.Cross]:"#e2e2e2"},Se={[m.Dots]:1,[m.Lines]:1,[m.Cross]:6},_e=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function Y({id:t,variant:l=m.Dots,gap:o=20,size:T,lineWidth:c=1,offset:u=2,color:y,style:w,className:v}){const k=n.useRef(null),{transform:i,patternId:z}=X(_e,Z),B=y||Ce[l],H=T||Se[l],b=l===m.Dots,E=l===m.Cross,C=Array.isArray(o)?o:[o,o],x=[C[0]*i[2]||1,C[1]*i[2]||1],g=H*i[2],a=E?[g,g]:x,r=b?[g/u,g/u]:[a[0]/u,a[1]/u];return e.createElement("svg",{className:P(["react-flow__background",v]),style:{...w,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:k,"data-testid":"rf__background"},e.createElement("pattern",{id:z+t,x:i[0]%x[0],y:i[1]%x[1],width:x[0],height:x[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${r[0]},-${r[1]})`},b?e.createElement(be,{color:B,radius:g/u}):e.createElement(ke,{dimensions:a,color:B,lineWidth:c})),e.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${z+t})`}))}Y.displayName="Background";var $e=n.memo(Y);function ze({data:t}){const l=()=>{t.url&&window.open(t.url,"_blank")};return e.createElement(S,{className:"min-w-48 max-w-64 shadow-md hover:shadow-lg transition-shadow cursor-pointer"},e.createElement(d,{type:"target",position:p.Top}),e.createElement(A,{className:"pb-2"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(F,{className:"w-4 h-4 text-orange-600"}),e.createElement("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:t.skill.color}})),t.url&&e.createElement(M,{className:"w-4 h-4 text-gray-400 hover:text-gray-600",onClick:l})),e.createElement(j,{className:"text-sm font-medium"},t.name)),e.createElement(_,{className:"pt-0"},e.createElement("div",{className:"space-y-2"},e.createElement($,{className:`text-xs ${t.statusColor}`},t.status.replace("_"," ")),e.createElement("p",{className:"text-xs text-gray-600"},t.skill.name),t.description&&e.createElement("p",{className:"text-xs text-gray-500 line-clamp-2"},t.description))),e.createElement(d,{type:"source",position:p.Bottom}))}function Be({data:t}){const l=()=>{t.url&&window.open(t.url,"_blank")};return e.createElement(S,{className:"min-w-48 max-w-64 shadow-md hover:shadow-lg transition-shadow cursor-pointer"},e.createElement(d,{type:"target",position:p.Top}),e.createElement(A,{className:"pb-2"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(U,{className:"w-4 h-4 text-yellow-600"}),e.createElement("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:t.skill.color}})),t.url&&e.createElement(M,{className:"w-4 h-4 text-gray-400 hover:text-gray-600",onClick:l})),e.createElement(j,{className:"text-sm font-medium"},t.name)),e.createElement(_,{className:"pt-0"},e.createElement("div",{className:"space-y-2"},e.createElement($,{className:`text-xs ${t.statusColor}`},t.status.replace("_"," ")),e.createElement("p",{className:"text-xs text-gray-600"},t.skill.name),t.description&&e.createElement("p",{className:"text-xs text-gray-500 line-clamp-2"},t.description))),e.createElement(d,{type:"source",position:p.Bottom}))}function He({data:t}){const l=()=>{t.url&&window.open(t.url,"_blank")};return e.createElement(S,{className:"min-w-48 max-w-64 shadow-md hover:shadow-lg transition-shadow cursor-pointer"},e.createElement(d,{type:"target",position:p.Top}),e.createElement(A,{className:"pb-2"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(W,{className:"w-4 h-4 text-indigo-600"}),e.createElement("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:t.skill.color}})),t.url&&e.createElement(M,{className:"w-4 h-4 text-gray-400 hover:text-gray-600",onClick:l})),e.createElement(j,{className:"text-sm font-medium"},t.name)),e.createElement(_,{className:"pt-0"},e.createElement("div",{className:"space-y-2"},e.createElement($,{className:`text-xs ${t.statusColor}`},t.status.replace("_"," ")),e.createElement("p",{className:"text-xs text-gray-600"},t.skill.name),t.description&&e.createElement("p",{className:"text-xs text-gray-500 line-clamp-2"},t.description))),e.createElement(d,{type:"source",position:p.Bottom}))}function Ae({data:t}){const l=()=>{t.url&&window.open(t.url,"_blank")};return e.createElement(S,{className:"min-w-48 max-w-64 shadow-md hover:shadow-lg transition-shadow cursor-pointer"},e.createElement(d,{type:"target",position:p.Top}),e.createElement(A,{className:"pb-2"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(K,{className:"w-4 h-4 text-purple-600"}),e.createElement("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:t.skill.color}})),t.url&&e.createElement(M,{className:"w-4 h-4 text-gray-400 hover:text-gray-600",onClick:l})),e.createElement(j,{className:"text-sm font-medium"},t.name)),e.createElement(_,{className:"pt-0"},e.createElement("div",{className:"space-y-2"},e.createElement($,{className:`text-xs ${t.statusColor}`},t.status.replace("_"," ")),e.createElement("p",{className:"text-xs text-gray-600"},t.skill.name),t.description&&e.createElement("p",{className:"text-xs text-gray-500 line-clamp-2"},t.description))),e.createElement(d,{type:"source",position:p.Bottom}))}function je({data:t}){const l=()=>{t.url&&window.open(t.url,"_blank")};return e.createElement(S,{className:"min-w-48 max-w-64 shadow-md hover:shadow-lg transition-shadow cursor-pointer"},e.createElement(d,{type:"target",position:p.Top}),e.createElement(A,{className:"pb-2"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(q,{className:"w-4 h-4 text-green-600"}),e.createElement("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:t.skill.color}})),t.url&&e.createElement(M,{className:"w-4 h-4 text-gray-400 hover:text-gray-600",onClick:l})),e.createElement(j,{className:"text-sm font-medium"},t.name)),e.createElement(_,{className:"pt-0"},e.createElement("div",{className:"space-y-2"},e.createElement($,{className:`text-xs ${t.statusColor}`},t.status.replace("_"," ")),e.createElement("p",{className:"text-xs text-gray-600"},t.skill.name),t.description&&e.createElement("p",{className:"text-xs text-gray-500 line-clamp-2"},t.description))),e.createElement(d,{type:"source",position:p.Bottom}))}function Te({data:t,isConnectable:l}){return e.createElement("div",{className:"skill-node bg-white border-2 rounded-lg shadow-xl min-w-48 max-w-64 relative",style:{borderColor:t.color}},e.createElement("div",{className:"absolute inset-0 rounded-lg blur-sm -z-10",style:{backgroundColor:t.color+"30",filter:"blur(4px)"}}),e.createElement("div",{className:"px-4 py-3 rounded-t-lg border-b-2",style:{backgroundColor:t.color+"20",borderColor:t.color}},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:t.color}}),e.createElement(ae,{className:"w-4 h-4",style:{color:t.color}})),e.createElement($,{variant:"secondary",className:"text-xs"},t.activities_count," activities"))),e.createElement("div",{className:"p-4"},e.createElement("h3",{className:"font-semibold text-lg mb-2 text-gray-900"},t.name),t.description&&e.createElement("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2"},t.description),e.createElement("div",{className:"flex items-center justify-center"},e.createElement("div",{className:"text-xs font-medium px-2 py-1 rounded",style:{backgroundColor:t.color+"15",color:t.color}},"SKILL ROOT"))),e.createElement(d,{type:"source",position:p.Bottom,isConnectable:l,style:{background:t.color,border:`2px solid ${t.color}`,width:12,height:12}}))}const Ve={skill:Te,course:Ee,project:je,book:ze,practice:Ae,certification:Be,other:He},Me=t=>{switch(t){case"course":return e.createElement(ne,{className:"h-4 w-4"});case"project":return e.createElement(q,{className:"h-4 w-4"});case"book":return e.createElement(F,{className:"h-4 w-4"});case"practice":return e.createElement(K,{className:"h-4 w-4"});case"certification":return e.createElement(U,{className:"h-4 w-4"});case"other":return e.createElement(W,{className:"h-4 w-4"})}},De=t=>{switch(t){case"not_started":return"bg-gray-100 text-gray-800";case"in_progress":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"paused":return"bg-yellow-100 text-yellow-800"}};function Ze(){const[t,l]=n.useState("all"),[o,T]=n.useState([]),[c,u]=n.useState([]),[y,w,v]=me([]),[k,i,z]=ue([]),[B,H]=n.useState(!0),b=n.useCallback(async()=>{try{const r=await(await fetch("/api/skills")).json();T(r)}catch(a){console.error("Error fetching skills:",a)}},[]),E=n.useCallback(async()=>{try{const a=t==="all"?"/api/activities":`/api/activities?skill_id=${t}`,h=await(await fetch(a)).json();u(h)}catch(a){console.error("Error fetching activities:",a)}},[t]),C=n.useCallback(()=>{const a=Array.from(new Map(c.map(s=>[s.skill_id,s.skill])).values()),r=a.map((s,N)=>{const D=c.filter(Q=>Q.skill_id===s.id);return{id:`skill-${s.id}`,type:"skill",position:{x:50,y:50+N*250},data:{...s,activities_count:D.length}}}),h=c.map(s=>{const N=a.findIndex(D=>D.id===s.skill_id);return{id:s.id.toString(),type:s.type,position:{x:s.position_x||300+Math.random()*500,y:s.position_y||50+N*250+Math.random()*200},data:{...s,label:s.name,icon:Me(s.type),statusColor:De(s.status)}}}),f=[];c.forEach(s=>{s.depends_on.forEach(N=>{f.push({id:`${N.id}-${s.id}`,source:N.id.toString(),target:s.id.toString(),type:"smoothstep",animated:s.status==="in_progress",style:{stroke:s.skill.color}})})}),c.forEach(s=>{s.depends_on.length===0&&f.push({id:`skill-${s.skill_id}-${s.id}`,source:`skill-${s.skill_id}`,target:s.id.toString(),type:"smoothstep",animated:s.status==="in_progress",style:{stroke:s.skill.color,strokeWidth:3}})}),console.log(r,h,f),w([...r,...h]),i(f)},[c,w,i]),x=n.useCallback(async(a,r)=>{var f;let h="";r.id.startsWith("skill-")?h="skills":h="activities";try{await fetch(`/api/${h}/${r.id}/position`,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((f=document.querySelector('meta[name="csrf-token"]'))==null?void 0:f.getAttribute("content"))||""},body:JSON.stringify({position_x:r.position.x,position_y:r.position.y})})}catch(s){console.error("Error saving node position:",s)}console.log(c,k)},[c,k]);n.useEffect(()=>{(async()=>{H(!0),await b(),await E(),H(!1)})()},[b,E]),n.useEffect(()=>{C()},[C]);const g=n.useCallback(a=>i(r=>de(a,r)),[i]);return B?e.createElement(O,null,e.createElement(R,{title:"Skill Graph"}),e.createElement("div",{className:"flex h-64 items-center justify-center"},e.createElement("div",{className:"h-32 w-32 animate-spin rounded-full border-b-2 border-blue-600"}))):e.createElement(O,null,e.createElement(R,{title:"Skill Graph"}),e.createElement("div",{className:"flex h-[calc(100vh-theme(spacing.16))] flex-col space-y-6"},e.createElement("div",{className:"flex flex-shrink-0 items-center justify-between"},e.createElement("div",null,e.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Skill Graph"),e.createElement("p",{className:"text-gray-600"},"Visualize your learning journey and skill dependencies")),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement(ee,{value:t,onValueChange:l},e.createElement(te,{className:"w-48"},e.createElement(se,{placeholder:"Select skill"})),e.createElement(le,null,e.createElement(G,{value:"all"},"All Skills"),o.map(a=>e.createElement(G,{key:a.id,value:a.id.toString()},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement("div",{className:"h-3 w-3 rounded-full",style:{backgroundColor:a.color}}),e.createElement("span",null,a.name)))))),e.createElement(L,{onClick:()=>I.visit("/skills")},e.createElement(re,{className:"mr-2 h-4 w-4"}),"Manage Skills"),e.createElement(L,{onClick:()=>I.visit("/activities")},e.createElement(he,{className:"mr-2 h-4 w-4"}),"Manage Activities"))),e.createElement("div",{className:"grid flex-shrink-0 grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4"},o.map(a=>e.createElement(S,{key:a.id,className:"cursor-pointer transition-shadow hover:shadow-md"},e.createElement(A,{className:"pb-3"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"h-4 w-4 rounded-full",style:{backgroundColor:a.color}}),e.createElement($,{variant:"secondary"},a.activities_count)),e.createElement(j,{className:"text-lg"},a.name)),a.description&&e.createElement(_,{className:"pt-0"},e.createElement("p",{className:"text-sm text-gray-600"},a.description))))),e.createElement(S,{className:"min-h-0 flex-1"},e.createElement(_,{className:"h-full p-0"},e.createElement(pe,{nodes:y,edges:k,onNodesChange:v,onEdgesChange:z,onConnect:g,onNodeDragStop:x,nodeTypes:Ve,fitView:!0,attributionPosition:"bottom-left"},e.createElement(ve,null),e.createElement($e,{variant:m.Dots,gap:12,size:1}))))))}export{Ze as default};
